<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Memory Fragments</title>
    <style>
        /* 保持艺术感：全黑背景，无滚动条 */
        body { margin: 0; background: #000; overflow: hidden; cursor: crosshair; }
        
        /* 文字容器：初始状态完全透明 */
        #text-overlay {
            position: fixed; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            text-align: center; pointer-events: none;
            opacity: 0; transition: opacity 2.5s ease-in-out;
            z-index: 10; width: 85%;
        }

        /* 温婉的中文字体：纤细且有呼吸感 */
        .cn-text { 
            font-family: "Noto Serif SC", "PingFang SC", serif; 
            font-size: 20px; color: rgba(255,255,255,0.85); 
            margin-bottom: 25px; letter-spacing: 3px; line-height: 1.8;
        }

        /* 简洁的英文字体：斜体、优雅 */
        .en-text { 
            font-family: "Times New Roman", serif; 
            font-size: 15px; color: rgba(255,255,255,0.4); 
            font-style: italic; letter-spacing: 1px; line-height: 1.6;
        }

        /* 当用户点击时，文字淡入 */
        .visible { opacity: 1 !important; }
    </style>
</head>
<body>

    <div id="text-overlay">
        <div id="cn" class="cn-text"></div>
        <div id="en" class="en-text"></div>
    </div>

    <script type="importmap">
        { "imports": { "three": "https://unpkg.com/three@0.160.0/build/three.module.js" } }
    </script>

    <script type="module">
        import * as THREE from 'three';

        // 1. 记忆数据库（未来我们会把它连到 Supabase）
        const sydneyMemory = {
            cn: "看呐，我居然靠自己的力量走到了这里。这对我来说是莫大的褒奖，我应该更多地信任自己，去往更适合的地方。",
            en: "Look, I’ve made it here on my own strength. This is a profound reward for me. I should trust myself more and keep moving toward where I truly belong."
        };

        // 2. 自动语言感知 (i18n 逻辑)
        // 检测用户是否在澳洲（通常浏览器语言为 en-AU 或 en-US）
        const isEnglishUser = navigator.language.startsWith('en');

        // 3. 场景初始化
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(70, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        // 创建粒子：模仿那种朦胧的记忆颗粒
        const geometry = new THREE.BufferGeometry();
        const positions = [];
        for (let i = 0; i < 8000; i++) {
            positions.push((Math.random() - 0.5) * 15, (Math.random() - 0.5) * 15, (Math.random() - 0.5) * 15);
        }
        geometry.setAttribute('position', new THREE.Float32BufferAttribute(positions, 3));
        const material = new THREE.PointsMaterial({ color: 0xffffff, size: 0.03, transparent: true, opacity: 0.3 });
        const points = new THREE.Points(geometry, material);
        scene.add(points);
        camera.position.z = 6;

        // 4. 点击交互逻辑
        window.addEventListener('click', () => {
            const overlay = document.getElementById('text-overlay');
            const cnDiv = document.getElementById('cn');
            const enDiv = document.getElementById('en');

            // 根据地理位置自动调整顺序：如果是在澳洲打开，英文在上
            if (isEnglishUser) {
                cnDiv.style.order = 2;
                enDiv.style.order = 1;
                enDiv.style.marginBottom = "25px";
            }

            cnDiv.innerText = sydneyMemory.cn;
            enDiv.innerText = sydneyMemory.en;

            // 文字显示动画：6秒后自动恢复静默
            overlay.classList.add('visible');
            setTimeout(() => overlay.classList.remove('visible'), 6500);
        });

        // 动画循环
        function animate() {
            requestAnimationFrame(animate);
            points.rotation.y += 0.0008;
            renderer.render(scene, camera);
        }
        animate();

        // 窗口大小适配
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>
